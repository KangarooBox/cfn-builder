{{!--
  Creates a Transfer Family User
  https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-transfer-user.html
--}}

"tu{{sanitize this.Name ''}}": {
  "Type": "AWS::Transfer::User",
  "Properties": {

    "Role": {{#ifObject this.Role}}
        { {{{inject this.Role}}} }
      {{else}}
        "{{this.Role}}"
      {{/ifObject}},

    "ServerId": {{#ifObject this.ServerId}}
        { {{{inject this.ServerId}}} }
      {{else}}
        { "Ref":"ts{{sanitize this.ServerId ''}}" }
      {{/ifObject}},

    "UserName": "{{this.UserName}}",

    {{#if this.HomeDirectory}}
      "HomeDirectory": "{{ this.HomeDirectory }}",
    {{/if}}

    {{# if this.HomeDirectoryMappings }}
      {{#with this.HomeDirectoryMappings}}
        "HomeDirectoryMappings": [
          {{#each this}}
            { {{{inject this}}} }{{comma}}
          {{/each}} ],
      {{/with}}
    {{/if}}

    {{#if this.HomeDirectoryType}}
      "HomeDirectoryType": "{{ this.HomeDirectoryType }}",
    {{/if}}

    {{#if this.Policy}}
      "Policy": "{{ this.Policy }}",
    {{/if}}

    {{#if this.PosixProfile}}
      "PosixProfile": { {{{inject this.PosixProfile}}} },
    {{/if}}

    {{# if this.SshPublicKeys }}
      {{#with this.SshPublicKeys}}
        "SshPublicKeys": [
          {{#each this}}
            { {{{inject this}}} }{{comma}}
          {{/each}} ],
      {{/with}}
    {{/if}}

    {{> tags}}
    }
}

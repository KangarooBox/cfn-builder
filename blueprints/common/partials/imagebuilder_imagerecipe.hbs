{{!--
  Creates an Image Builder Image Recipe
https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-imagebuilder-imagerecipe.html
--}}

"imagebuilder{{sanitize this.Name ''}}":{
  "Type" : "AWS::ImageBuilder::ImageRecipe",
  "Properties" : {

      {{#if this.Description}}
        "Description" : "{{this.Description}}",
      {{/if}}

      {{#if this.BlockDeviceMappings}}
        "BlockDeviceMappings":[{{#each this.BlockDeviceMappings}}{ {{{inject this}}} }{{#unless @last}},{{/unless}}{{/each}}],
      {{/if}}

        "Components" : [
          {{#with this.Components}}
          {{#each this}}
            {
              {{{inject this}}}
            }
            {{#unless @last}},{{/unless}}
          {{/each}}
          {{/with}}
          ],

        "Name" : "{{this.Name}}",

        "ParentImage" : "{{this.ParentImage}}",

        "Version" : "{{this.Version}}",

      {{#if this.WorkingDirectory}}
        "WorkingDirectory" : "{{this.WorkingDirectory}}",
      {{/if}}

      {{> tags_map}}
    }
}

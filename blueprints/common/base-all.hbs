{
  "AWSTemplateFormatVersion" : "2010-09-09",
  {{#if this.Description}}
    "Description": "{{this.Description}}",
  {{else}}
    "Description" : "{{ProjectName}} ({{EnvVersion}}{{EnvName}})",
  {{/if}}

  {{#ifObject this.Parameters}}
    "Parameters": { {{{inject this.Parameters}}} },
  {{/ifObject}}

  "Metadata" : {
    {{#each Metadata}}{{{inject this}}},{{/each}}
    {{> tags Name=ProjectName}},
    "Environment" : "{{EnvName}}",
    "Version"     : "{{EnvVersion}}",
    "ProjectName" : "{{ProjectName}}",
    "Region"      : "{{Region.Id}}",
    "Role"        : "{{ProjectName}}"
  },

  "Mappings" : {
    {{#each Mappings}}{{{this}}}
    {{/each}}
  },

  "Conditions":{
    "Disabled": {"Fn::Equals":["true","false"]}
  },

  "Resources" : {
    {{#each CustomResources}}
      {{{inject this}}},
    {{/each}}

    {{#each AccessKeys}}
    {{> iam_accesskey}},
    {{/each}}

    {{#each ACMCertificates}}
    {{> certificatemanager_certificate}},
    {{/each}}

    {{#each APIs}}
    {{> apigateway_restapi}},
    {{/each}}

    {{#each APIResources}}
    {{> apigateway_resource}},
    {{/each}}

    {{#each APIMethods}}
    {{> apigateway_method}}
    {{/each}}

    {{#each APIModels}}
    {{> apigateway_model}},
    {{/each}}

    {{#each APIDomainNames}}
    {{> apigateway_domain_name}},
    {{/each}}

    {{#each AutoScalingGroups}}
    {{> autoscaling_group}},
    {{/each}}

    {{#each AutoScalingScalingPolicies}}
    {{> autoscaling_scalingpolicy}},
    {{/each}}

    {{#each AutoScalingScheduledActions}}
    {{> autoscaling_scheduledaction}},
    {{/each}}

    {{#each AutoScalingLaunchConfigurations}}
    {{> autoscaling_launchconfiguration}},
    {{/each}}

    {{#each CloudTrailTrails}}
    {{> cloudtrail_trail}},
    {{/each}}

    {{#each CloudWatchAlarms}}
    {{> cloudwatch_alarm}},
    {{/each}}

    {{#each CodeCommitRepositories}}
    {{> codecommit_repository}},
    {{/each}}

    {{#each CodeDeployApplications}}
    {{> codedeploy_application}},
    {{/each}}

    {{#each CodeDeployDeploymentGroups}}
    {{> codedeploy_deploymentgroup}},
    {{/each}}

    {{#each CodePipelinePipelines}}
    {{> codepipeline_pipeline}},
    {{/each}}

    {{#each ConfigConfigurationAggregators}}
    {{> config_configurationaggregator}},
    {{/each}}

    {{#each ConfigAggregationAuthorizations}}
    {{> config_aggregationauthorization}},
    {{/each}}

    {{#each ConfigConfigurationRecorders}}
    {{> config_configurationrecorder}},
    {{/each}}

    {{#each ConfigDeliveryChannels}}
    {{> config_deliverychannel}},
    {{/each}}

    {{#each ConfigRules}}
    {{> config_rule}},
    {{/each}}

    {{#each CognitoUserPools}}
    {{> cognito_userpool}},
    {{/each}}

    {{#each CognitoUserPoolClients}}
    {{> cognito_userpoolclient}},
    {{/each}}

    {{#each DataPipelines}}
    {{> datapipeline_pipeline}},
    {{/each}}

    {{#each DirectoryServiceMicrosoftADs}}
    {{> directoryservice_microsoftad}},
    {{/each}}

    {{#each DirectoryServiceSimpleADs}}
    {{> directoryservice_simplead}},
    {{/each}}

    {{#each DLMLifecyclePolicies}}
    {{> dlm_lifecyclepolicy}},
    {{/each}}

    {{#each EC2CustomerGateways}}
    {{> ec2_customergateway}},
    {{/each}}

    {{#each EC2DHCPOptions}}
    {{> ec2_dhcpoptions}},
    {{/each}}

    {{#each EC2EIPs}}
    {{> ec2_eip}},
    {{/each}}

    {{#each EC2FlowLogs}}
    {{> ec2_flowlog}},
    {{/each}}

    {{#each EC2NetworkInterfaces}}
    {{> ec2_networkinterface}},
    {{/each}}

    {{#each EC2NetworkInterfaceAttachments}}
    {{> ec2_networkinterfaceattachment}},
    {{/each}}

    {{#each EC2SpotFleets}}
    {{> ec2_spotfleet}},
    {{/each}}

    {{#each EC2TransitGateways}}
    {{> ec2_transitgateway}},
    {{/each}}

    {{#each EC2TransitGatewayAttachments}}
    {{> ec2_transitgatewayattachment}},
    {{/each}}

    {{#each EC2TransitGatewayRoutes}}
    {{> ec2_transitgatewayroute}},
    {{/each}}

    {{#each EC2TransitGatewayRouteTables}}
    {{> ec2_transitgatewayroutetable}},
    {{/each}}

    {{#each EC2TransitGatewayRoutes}}
    {{> ec2_transitgatewayroute}},
    {{/each}}

    {{#each EC2VPCs}}
    {{> ec2_vpc}},
    {{/each}}

    {{#each EC2VPCEndpoints}}
    {{> ec2_vpcendpoint}},
    {{/each}}

    {{#each EC2VPCEndpointServices}}
    {{> ec2_vpcendpointservice}},
    {{/each}}

    {{#each EC2VPCEndpointServicePermissions}}
    {{> ec2_vpcendpointservicepermission}},
    {{/each}}

    {{#each EC2VPCPeeringConnections}}
    {{> ec2_vpcpeeringconnection}},
    {{/each}}

    {{#each EC2VPNConnections}}
    {{> ec2_vpnconnection}},
    {{/each}}

    {{#each EC2VPNConnectionRoutes}}
    {{> ec2_vpnconnectionroute}},
    {{/each}}

    {{#each EC2NATGateways}}
    {{> ec2_natgateway}},
    {{/each}}

    {{#each EC2Instances}}
    {{> ec2_instance}},
    {{/each}}

    {{#each EC2Routes}}
    {{> ec2_route}},
    {{/each}}

    {{#each EC2RouteTables}}
    {{> ec2_routetable}},
    {{/each}}

    {{#each EC2SecurityGroups}}
    {{> ec2_securitygroup}},
    {{/each}}

    {{#each EC2SecurityGroupEgresses}}
    {{> ec2_securitygroupegress}},
    {{/each}}

    {{#each EC2SecurityGroupIngresses}}
    {{> ec2_securitygroupingress}},
    {{/each}}

    {{#each EC2Subnets}}
    {{> ec2_subnet}},
    {{/each}}

    {{#each EC2SubnetRouteTableAssociations}}
    {{> ec2_subnetroutetableassociation}},
    {{/each}}

    {{#each EC2Volumes}}
    {{> ec2_volume}},
    {{/each}}

    {{#each ECSServices}}
    {{> ecs_service}},
    {{/each}}

    {{#each ECSTaskDefinitions}}
    {{> ecs_taskdefinition}},
    {{/each}}

    {{#each EFSFileSystems}}
    {{> efs_filesystem}},
    {{/each}}

    {{#each EFSMountTargets}}
    {{> efs_mounttarget}},
    {{/each}}

    {{#each ElastiCacheClusters}}
    {{> elasticache_cachecluster}},
    {{/each}}

    {{#each ElastiCacheParameterGroups}}
    {{> elasticache_parametergroup}},
    {{/each}}

    {{#each ElasticLoadBalancers}}
    {{> elasticloadbalancing_loadbalancer}},
    {{/each}}

    {{#each ElasticLoadBalancersV2}}
    {{> elasticloadbalancingv2_loadbalancer}},
    {{/each}}

    {{#each ElasticLoadBalancerV2TargetGroups}}
    {{> elasticloadbalancingv2_targetgroup}},
    {{/each}}

    {{#each EventsRules}}
    {{> events_rule}},
    {{/each}}

    {{#each EventSourceMappings}}
    {{> lambda_event_source_mapping}},
    {{/each}}

    {{#each IAMInstanceProfiles}}
    {{> iam_instanceprofile}},
    {{/each}}

    {{#each IAMManagedPolicies}}
    {{> iam_managedpolicy}},
    {{/each}}

    {{#each IAMRoles}}
    {{> iam_role}},
    {{/each}}

    {{#each IAMUsers}}
    {{> iam_user}},
    {{/each}}

    {{#each IAMUsersToGroups}}
    {{> iam_usertogroupaddition}},
    {{/each}}

    {{#each IAMGroups}}
    {{> iam_group}},
    {{/each}}

    {{#each KinesisStreams}}
    {{> kinesis_stream}},
    {{/each}}
    {{#each KinesisFirehoses}}
    {{> kinesis_firehose}},
    {{/each}}

    {{#each LambdaEventSourceMappings}}
    {{> lambda_event_source_mapping}},
    {{/each}}

    {{#each LambdaFunctions}}
    {{> lambda_function}},
    {{/each}}

    {{#each LambdaPermissions}}
    {{> lambda_permission}},
    {{/each}}

    {{#each LogsLogGroups}}
    {{> logs_loggroup}},
    {{/each}}

    {{#each LogsMetricFilters}}
    {{> logs_metricfilter}},
    {{/each}}

    {{#each OpsWorksELBAttachments}}
    {{> opsworks_elasticloadbalancerattachment}},
    {{/each}}

    {{#each OpsWorksLayers}}
    {{> opsworks_layer}},
    {{/each}}

    {{#each OpsWorksStacks}}
    {{> opsworks_stack}},
    {{/each}}

    {{#each RAMResourceShares}}
    {{> ram_resourceshare}},
    {{/each}}

    {{#each RDSInstances}}
    {{> rds_instance}},
    {{/each}}

    {{#each RedshiftClusters}}
    {{> redshift_cluster}},
    {{/each}}

    {{#each Route53HealthChecks}}
    {{> route53_healthcheck}},
    {{/each}}

    {{#each Route53HostedZones}}
    {{> route53_hostedzone}},
    {{/each}}

    {{#each Route53RecordSetGroups}}
    {{> route53_recordsetgroup}},
    {{/each}}

    {{#each Route53RecordSets}}
    {{> route53_recordset}},
    {{/each}}

    {{#each S3Buckets}}
    {{#ifEq this.Region @root.Region.Id}}
    {{> s3_bucket}},
    {{/ifEq}}
    {{/each}}

    {{#each S3BucketPolicies}}
    {{> s3_bucketpolicy}},
    {{/each}}

    {{#each SecretsManagerSecrets}}
    {{> secretsmanager_secret}},
    {{/each}}

    {{#each SNSTopics}}
    {{> sns_topic}},
    {{/each}}

    {{#each SNSTopicPolicies}}
    {{> sns_topicpolicy}},
    {{/each}}

    {{#each SSMAssociations}}
    {{> ssm_association}},
    {{/each}}

    {{#each SSMDocuments}}
    {{> ssm_document}},
    {{/each}}

    {{#each SSMParameters}}
    {{> ssm_parameter}},
    {{/each}}

    {{#each SQSQueues}}
    {{> sqs_queue}},
    {{/each}}

    {{#each SQSQueuePolicies}}
    {{> sqs_queue_policy}},
    {{/each}}

    {{#each WAFWebACLs}}
    {{> waf_webacl}},
    {{/each}}

    {{#each WAFRules}}
    {{> waf_rule}},
    {{/each}}

    {{#each WAFRegionalByteMatchSets}}
    {{> wafregional_bytematchset}},
    {{/each}}

    {{#each WAFRegionalSqlInjectionMatchSets}}
    {{> wafregional_sqlinjectionmatchset}},
    {{/each}}

    {{#each WAFRegionalWebACLs}}
    {{> wafregional_webacl}},
    {{/each}}

    {{#each WAFRegionalWebACLAssociations}}
    {{> wafregional_webaclassociation}},
    {{/each}}

    {{#each WAFRegionalRules}}
    {{> wafregional_rule}},
    {{/each}}

    {{#each WorkspacesWorkspaces}}
    {{> workspaces_workspace}},
    {{/each}}

    "JSONTerminator" : {
      "Type" : "AWS::CloudFormation::WaitConditionHandle",
      "Properties" : {}
    }
  },

  "Outputs" : {
{{!--
    {{#each AccessKeys}}
    {{> iam_accesskey_output}},
    {{/each}}
    {{#each KinesisFirehoses}}
    {{> kinesis_firehose_output}},
    {{/each}}
    {{#each KinesisStreams}}
    {{> kinesis_stream_output}},
    {{/each}}
    {{#each IAMRoles}}
    {{> iam_role_output}},
    {{/each}}
    {{#each RedshiftClusters}}
    {{> redshift_cluster_output}},
    {{/each}}
    {{#each SSMDocuments}}
    {{> ssm_document_output}},
    {{/each}}
 --}}
    "StackId" : { "Value" : { "Ref" : "AWS::StackId" }, "Description" : "CloudFormation stack id" }
  }
}
